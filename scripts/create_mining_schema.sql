DROP TABLE inspections;

CREATE TABLE `inspections` ( 
 `EVENT_NO` VARCHAR(100),
  `MINE_ID` VARCHAR(100),
  `INSPECTION_BEGIN_DT` VARCHAR(100),
  `INSPECTION_END_DT` VARCHAR(100),
  `CONTROLLER_ID` VARCHAR(100),
  `CONTROLLER_NAME` VARCHAR(100),
  `OPERATOR_ID` VARCHAR(100),
  `OPERATOR_NAME` VARCHAR(100),
  `CAL_YR` int(4),
  `CAL_QTR` int(1),
  `FISCAL_YR` int(4),
  `FISCAL_QTR` int(1),
  `INSPECT_OFFICE_CD` VARCHAR(100),
  `ACTIVITY_CODE` VARCHAR(100),
  `ACTIVITY` VARCHAR(100),
  `ACTIVE_SECTIONS` int(5),
  `IDLE_SECTIONS` int(5),
  `SHAFT_SLOPE_SINK` int(5),
  `IMPOUND_CONSTR` int(5),
  `BLDG_CONSTR_SITES` int(5),
  `DRAGLINES` int(5),
  `UNCLASSIFIED_CONSTR` int(5),
  `CO_RECORDS` VARCHAR(100),
  `SURF_UG_MINE` VARCHAR(100),
  `SURF_FACILITY_MINE` VARCHAR(100),
  `REFUSE_PILES` VARCHAR(100),
  `EXPLOSIVE_STORAGE` VARCHAR(100),
  `OUTBY_AREAS` VARCHAR(100),
  `MAJOR_CONSTR` VARCHAR(100),
  `SHAFTS_SLOPES` VARCHAR(100),
  `IMPOUNDMENTS` VARCHAR(100),
  `MISC_AREA` VARCHAR(100),
  `PROGRAM_AREA` VARCHAR(100),
  `SAMPLE_CNT_AIR` float,
  `SAMPLE_CNT_DUSTSPOT` float,
  `SAMPLE_CNT_DUSTSURVEY` float,
  `SAMPLE_CNT_RESPDUST` float,
  `SAMPLE_CNT_NOISE` float,
  `SAMPLE_CNT_OTHER` float,
  `NBR_INSPECTORS` int(5),
  `TOTAL_ON_SITE_HOURS` int(5),
  `TOTAL_INSP_HOURS` int(5),
  `COAL_METAL_IND` VARCHAR(100),
  `TOTAL_ON_SITE_HRS_SPVR_TRAINEE` int(5),
  `TOTAL_INSP_HRS_SPVR_TRAINEE` int(5),
 PRIMARY KEY (`EVENT_NO`) 
) ENGINE=InnoDB AUTO_INCREMENT=5506 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;



LOAD DATA LOCAL INFILE '/Users/ranjitkhanuja/Desktop/mining/Inspections.txt' INTO TABLE inspections
  FIELDS TERMINATED BY '|'
  LINES TERMINATED BY '\r\n'
  IGNORE 1 LINES;
  
  
DROP TABLE accidents;
CREATE TABLE `accidents` (
  `MINE_ID` VARCHAR(100),
  `CONTROLLER_ID` VARCHAR(100),
  `CONTROLLER_NAME` VARCHAR(100),
  `OPERATOR_ID` VARCHAR(100),
  `OPERATOR_NAME` VARCHAR(100),
  `CONTRACTOR_ID` VARCHAR(100),
  `DOCUMENT_NO` VARCHAR(100),
  `SUBUNIT_CD` VARCHAR(100),
  `SUBUNIT` VARCHAR(100),
  `ACCIDENT_DT` VARCHAR(100),
  `CAL_YR` int(4),
  `CAL_QTR` int(1),
  `FISCAL_YR` int(4),
  `FISCAL_QTR` int(1),
  `ACCIDENT_TIME` int(4),
  `DEGREE_INJURY_CD` VARCHAR(100),
  `DEGREE_INJURY` VARCHAR(100),
  `FIPS_STATE_CD` VARCHAR(100),
  `UG_LOCATION_CD` VARCHAR(100),
  `UG_LOCATION` VARCHAR(100),
  `UG_MINING_METHOD_CD` VARCHAR(100),
  `UG_MINING_METHOD` VARCHAR(100),
  `MINING_EQUIP_CD` VARCHAR(100),
  `MINING_EQUIP` VARCHAR(100),
  `EQUIP_MFR_CD` VARCHAR(100),
  `EQUIP_MFR_NAME` VARCHAR(100),
  `EQUIP_MODEL_NO` VARCHAR(100),
  `SHIFT_BEGIN_TIME` int(4),
  `CLASSIFICATION_CD` VARCHAR(100),
  `CLASSIFICATION` VARCHAR(100),
  `ACCIDENT_TYPE_CD` VARCHAR(100),
  `ACCIDENT_TYPE` VARCHAR(100),
  `NO_INJURIES` int(4),
  `TOT_EXPER` float,
  `MINE_EXPER` float,
  `JOB_EXPER` float,
  `OCCUPATION_CD` VARCHAR(100),
  `OCCUPATION` VARCHAR(100),
  `ACTIVITY_CD` VARCHAR(100),
  `ACTIVITY` VARCHAR(100),
  `INJURY_SOURCE_CD` VARCHAR(100),
  `INJURY_SOURCE` VARCHAR(100),
  `NATURE_INJURY_CD` VARCHAR(100),
  `NATURE_INJURY` VARCHAR(100),
  `INJ_BODY_PART_CD` VARCHAR(100),
  `INJ_BODY_PART` VARCHAR(100),
  `SCHEDULE_CHARGE` int(4),
  `DAYS_RESTRICT` int(4),
  `DAYS_LOST` int(3),
  `TRANS_TERM` VARCHAR(100),
  `RETURN_TO_WORK_DT` DATE,
  `IMMED_NOTIFY_CD` VARCHAR(100),
  `IMMED_NOTIFY` VARCHAR(100),
  `INVEST_BEGIN_DT` DATE,
  `NARRATIVE` VARCHAR(100),
  `CLOSED_DOC_NO` VARCHAR(100),
  `COAL_METAL_IND` VARCHAR(100),
 PRIMARY KEY (`MINE_ID`) 
) ENGINE=InnoDB AUTO_INCREMENT=5506 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

DROP TABLE area_samples;
CREATE TABLE `area_samples` ( 
 `MINE_ID` VARCHAR(100),
  `EVENT_NO` VARCHAR(100),
  `SAMPLE_NO` VARCHAR(100),
  `SAMPLE_DATE` VARCHAR(100),
  `CONTAMINANT_CD` VARCHAR(100),
  `CONTAMINANT_CD_DESC` VARCHAR(100),
  `CONCENTRATION` VARCHAR(100),
  `SAMPLE_START_TIME` VARCHAR(100),
  `SAMPLING_INSTRUMENT_CD` VARCHAR(100),
  `SAMPLING_INSTRUMENT_DESC` VARCHAR(100),
  `AREA_SAMPLED` VARCHAR(100),
  `LOCATION_CD` VARCHAR(100),
  `LOCATION_CD_DESC` VARCHAR(100),
  `MINERS_PRESENT` VARCHAR(100),
  `ACTION_TAKEN` VARCHAR(100),
  `ACTION_TAKEN_DESC` VARCHAR(100),
  `CONTRACTOR_ID` VARCHAR(100),
 PRIMARY KEY (`MINE_ID`) 
) ENGINE=InnoDB AUTO_INCREMENT=5506 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;



LOAD DATA LOCAL INFILE '/Users/ranjitkhanuja/Desktop/mining/AreaSamples.txt' INTO TABLE area_samples
  FIELDS TERMINATED BY '|'
  LINES TERMINATED BY '\r\n'
  IGNORE 1 LINES;
  
DROP TABLE personal_health_samples;
  
CREATE TABLE `personal_health_samples` (  `MINE_ID` VARCHAR(100),
  `EVENT_NO` VARCHAR(100),
  `SAMPLE_NO` VARCHAR(100),
  `SAMPLE_DATE` VARCHAR(100),
  `CONTAMINANT_CD` VARCHAR(100),
  `CONTAMINANT_CD_DESC` VARCHAR(100),
  `CONCENTRATION` VARCHAR(100),
  `EXPOSURE_LIMIT` VARCHAR(100),
  `C_OVER_E` VARCHAR(100),
  `PROTECTION_USED` VARCHAR(100),
  `SAMPLING_INSTRUMENT_CD` VARCHAR(100),
  `SAMPLING_INSTRUMENT_DESC` VARCHAR(100),
  `SHORT_TERM_EXPOSURE` VARCHAR(100),
  `ACTION_TAKEN` VARCHAR(100),
  `ACTION_TAKEN_DESC` VARCHAR(100),
  `LOCATION_CD` VARCHAR(100),
  `LOCATION_CD_DESC` VARCHAR(100),
  `JOB_CD` VARCHAR(100),
  `JOB_CD_DESC` VARCHAR(100),
  `CONTRACTOR_ID` VARCHAR(100),
 PRIMARY KEY (`MINE_ID`) 
) ENGINE=InnoDB AUTO_INCREMENT=5506 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;


LOAD DATA LOCAL INFILE '/Users/ranjitkhanuja/Desktop/mining/PersonalHealthSamples.txt' INTO TABLE personal_health_samples
  FIELDS TERMINATED BY '|'
  LINES TERMINATED BY '\r\n'
  IGNORE 1 LINES;
  
CREATE TABLE `violations` (  `EVENT_NO` VARCHAR(100),
  `INSPECTION_BEGIN_DT` VARCHAR(100),
  `INSPECTION_END_DT` VARCHAR(100),
  `VIOLATION_NO` VARCHAR(100),
  `CONTROLLER_ID` VARCHAR(100),
  `CONTROLLER_NAME` VARCHAR(100),
  `VIOLATOR_ID` VARCHAR(100),
  `VIOLATOR_NAME` VARCHAR(100),
  `VIOLATOR_TYPE_CD` VARCHAR(100),
  `MINE_ID` VARCHAR(100),
  `MINE_NAME` VARCHAR(100),
  `MINE_TYPE` VARCHAR(100),
  `COAL_METAL_IND` VARCHAR(100),
  `CONTRACTOR_ID` VARCHAR(100),
  `VIOLATION_ISSUE_DT` VARCHAR(100),
  `VIOLATION_OCCUR_DT` VARCHAR(100),
  `CAL_YR` int(4),
  `CAL_QTR` int(1),
  `FISCAL_YR` int(4),
  `FISCAL_QTR` int(1),
  `VIOLATION_ISSUE_TIME` VARCHAR(100),
  `SIG_SUB` VARCHAR(100),
  `SECTION_OF_ACT` VARCHAR(100),
  `PART_SECTION` VARCHAR(100),
  `SECTION_OF_ACT_1` VARCHAR(100),
  `SECTION_OF_ACT_2` VARCHAR(100),
  `CIT_ORD_SAFE` VARCHAR(100),
  `ORIG_TERM_DUE_DT` VARCHAR(100),
  `ORIG_TERM_DUE_TIME` VARCHAR(100),
  `LATEST_TERM_DUE_DT` VARCHAR(100),
  `LATEST_TERM_DUE_TIME` VARCHAR(100),
  `TERMINATION_DT` VARCHAR(100),
  `TERMINATION_TIME` VARCHAR(100),
  `TERMINATION_TYPE` VARCHAR(100),
  `VACATE_DT` VARCHAR(100),
  `VACATE_TIME` VARCHAR(100),
  `INITIAL_VIOL_NO` VARCHAR(100),
  `REPLACED_BY_ORDER_NO` VARCHAR(100),
  `LIKELIHOOD` VARCHAR(100),
  `INJ_ILLNESS` VARCHAR(100),
  `NO_AFFECTED` int(3),
  `NEGLIGENCE` VARCHAR(100),
  `WRITTEN_NOTICE` VARCHAR(100),
  `ENFORCEMENT_AREA` VARCHAR(100),
  `SPECIAL_ASSESS` VARCHAR(100),
  `PRIMARY_OR_MILL` VARCHAR(100),
  `RIGHT_TO_CONF_DT` VARCHAR(100),
  `ASMT_GENERATED_IND` VARCHAR(100),
  `FINAL_ORDER_ISSUE_DT` VARCHAR(100),
  `PROPOSED_PENALTY` float,
  `AMOUNT_DUE` float,
  `AMOUNT_PAID` float,
  `BILL_PRINT_DT` VARCHAR(100),
  `LAST_ACTION_CD` VARCHAR(100),
  `LAST_ACTION_DT` VARCHAR(100),
  `DOCKET_NO` VARCHAR(100),
  `DOCKET_STATUS_CD` VARCHAR(100),
  `CONTESTED_IND` VARCHAR(100),
  `CONTESTED_DT` VARCHAR(100),
  `VIOLATOR_VIOLATION_CNT` int(5),
  `VIOLATOR_INSPECTION_DAY_CNT` int(5),
 PRIMARY KEY (`EVENT_NO`) 
) ENGINE=InnoDB AUTO_INCREMENT=5506 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

LOAD DATA LOCAL INFILE '/Users/ranjitkhanuja/Desktop/mining/Violations.txt' INTO TABLE violations
  FIELDS TERMINATED BY '|'
  LINES TERMINATED BY '\r\n'
  IGNORE 1 LINES;
  
DROP TABLE mines;

CREATE TABLE `mines` (  `MINE_ID` VARCHAR(100),
  `CURRENT_MINE_NAME` VARCHAR(100),
  `COAL_METAL_IND` VARCHAR(100),
  `CURRENT_MINE_TYPE` VARCHAR(100),
  `CURRENT_MINE_STATUS` VARCHAR(100),
  `CURRENT_STATUS_DT` VARCHAR(100),
  `CURRENT_CONTROLLER_ID` VARCHAR(100),
  `CURRENT_CONTROLLER_NAME` VARCHAR(100),
  `CURRENT_OPERATOR_ID` VARCHAR(100),
  `CURRENT_OPERATOR_NAME` VARCHAR(100),
  `STATE` VARCHAR(100),
  `BOM_STATE_CD` VARCHAR(100),
  `FIPS_CNTY_CD` VARCHAR(100),
  `FIPS_CNTY_NM` VARCHAR(100),
  `CONG_DIST_CD` VARCHAR(100),
  `COMPANY_TYPE` VARCHAR(100),
  `CURRENT_CONTROLLER_BEGIN_DT` VARCHAR(100),
  `DISTRICT` VARCHAR(100),
  `OFFICE_CD` VARCHAR(100),
  `OFFICE_NAME` VARCHAR(100),
  `ASSESS_CTRL_NO` VARCHAR(100),
  `PRIMARY_SIC_CD` VARCHAR(100),
  `PRIMARY_SIC` VARCHAR(100),
  `PRIMARY_SIC_CD_1` VARCHAR(100),
  `PRIMARY_SIC_CD_SFX` VARCHAR(100),
  `SECONDARY_SIC_CD` VARCHAR(100),
  `SECONDARY_SIC` VARCHAR(100),
  `SECONDARY_SIC_CD_1` VARCHAR(100),
  `SECONDARY_SIC_CD_SFX` VARCHAR(100),
  `PRIMARY_CANVASS_CD` VARCHAR(100),
  `PRIMARY_CANVASS` VARCHAR(100),
  `SECONDARY_CANVASS_CD` VARCHAR(100),
  `SECONDARY_CANVASS` VARCHAR(100),
  `CURRENT_103I` VARCHAR(100),
  `CURRENT_103I_DT` VARCHAR(100),
  `PORTABLE_OPERATION` VARCHAR(100),
  `PORTABLE_FIPS_ST_CD` VARCHAR(100),
  `DAYS_PER_WEEK` int(2),
  `HOURS_PER_SHIFT` int(2),
  `PROD_SHIFTS_PER_DAY` int(3),
  `MAINT_SHIFTS_PER_DAY` int(3),
  `NO_EMPLOYEES` int(5),
  `PART48_TRAINING` VARCHAR(100),
  `LONGITUDE` VARCHAR(100),
  `LATITUDE` VARCHAR(100),
  `AVG_MINE_HEIGHT` int(5),
  `MINE_GAS_CATEGORY_CD` VARCHAR(100),
  `METHANE_LIBERATION` int(9),
  `NO_PRODUCING_PITS` int(3),
  `NO_NONPRODUCING_PITS` int(5),
  `NO_TAILING_PONDS` int(3),
  `PILLAR_RECOVERY_USED` VARCHAR(100),
  `HIGHWALL_MINER_USED` VARCHAR(100),
  `MULTIPLE_PITS` VARCHAR(100),
  `MINERS_REP_IND` VARCHAR(100),
  `SAFETY_COMMITTEE_IND` VARCHAR(100),
  `MILES_FROM_OFFICE` int(5),
  `DIRECTIONS_TO_MINE` VARCHAR(100),
  `NEAREST_TOWN` VARCHAR(100),
 PRIMARY KEY (`MINE_ID`) 
) ENGINE=InnoDB AUTO_INCREMENT=5506 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

LOAD DATA LOCAL INFILE '/Users/ranjitkhanuja/Desktop/mining/Mines.txt' INTO TABLE mines
  FIELDS TERMINATED BY '|'
  LINES TERMINATED BY '\r\n'
  IGNORE 1 LINES;